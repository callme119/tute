
<script>
    $(document).ready(function(){
        $("#loginform").validate({
            rules:{
                username:{
                    required:true,
                    minlength:2,
                    maxlength:30
                },
               password:{
                    required:true,
                    minlength:2,
                    maxlength:30
               }
            }
        })
        $("#login").click(function(){
            login();
        });
        $(document).on('keyup',function(e){
            if(e.keyCode === 13){
                login();
            }
        });
    });

    var login = function()
    {
        var username=document.getElementById("username").value;
        if(username.length < 4 || username.length > 20)
        {
            alertify.error("用户名长度需要介于4至20位之间");
            $("#username").focus();
            return false;
        }
        console.log(username);
        var password=document.getElementById("password").value;
        if(password.length < 6 || username.length > 20 )
        {
            alertify.error("密码长度需要介于6至20位之间");
            $("#password").focus();
            return false;
        }
        var remember=$("#remember").is(':checked');
        $.post(
            "{:U('Login/Index/checkAjax')}",
            {
                username:username,
                password:password,
                remember:remember
            },
            function(data){
                if(data.state == "error"){    
                    alertify.error(data.msg);
                    $("#password").focus();
                    return false;
                }else
                {
                    alertify.success("登陆成功,正在为您跳转")
                    location = "{:U('Admin/Index/index')}";
                }
            }
        ); 
    };

    //为ajax增加showloading
    loadingShowDefaults = {
        'position': "right",        // right | inside | overlay
        'text': "努力加载中...",                 // Text to display next to the loader
        'class': "icon-refresh",    // loader CSS class
        'tpl': '<span class="isloading-wrapper %wrapper%">%text%<i class="%class% icon-spin"></i></span>',
        'disableSource': true,      // true | false
        'disableOthers': []
    };

    //ajax开始
    $(document).ajaxStart(function(){
        $.isLoading(loadingShowDefaults);
    });

    //ajax结束
    $(document).ajaxStop(function(){
        $.isLoading('hide');
    });
</script>

